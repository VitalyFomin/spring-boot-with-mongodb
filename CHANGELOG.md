# CHANGE LOG #

-----
## 18.07.2016
### 0.7.20
- переход на версию Entities 1.2.8, версия протокола 1.0.0
- органичение авторизации пользователей (удаленные и неактивные)
- корректировка обновления связных сущностей (self model relation)
- селектор-сервер увеличил паузу на обнаружение радиомодулей - 40 сек
- BoxController - переработана логика поиска доступных шкафов для связвания с устройством
- UserServiceImpl - try на проверку анонимного пользователя (нужно для работы SelectorServer`a)
- Абстрактный контроллер - попытка заложить фильтрацию выборки данных в зависимости от разрешений пользователя. только начало и по объектам учета
- Добавлена фиксация пользователя сохранившего, обновившего запись. Добавлена фиксация времени удаления записи, инкремент версии удаляемой записи
- Время жизни сессии пользовтеля установлено в 3600 сек (1 час)
- Добавлен UserService (с целью получения текущего авторизованного пользователя)
- Классы User, Role - @Deprecated. Переход на соответствующие классы Entities
- MongoService - добавлен контроль hasMany полей сущностей (обратная связь) на которые ссылается сохраняемая запись (по BelongsToRelation аннтотации), добавлена очистка обратной при метке сущности удаленной
- AbstractEntityController - расширение методов подготовки query для запросов, добавлены вызовы MongoService


## 06.07.2016
### 0.7.1
- Добавлен MongoService (дополнительный слой абстракции для реализации связывания и частичного контроя связных сущностей)
- BoxController - дополнительная логика в методе getQuery для выбора доступных шкафов, относительно устройства и его типа (выводим только те шкафы, в которых имеется туп устройства и у которого еще не заполнены связи)

## 23.06.2016
### 0.6.24.1
- Extractor - метод конверсии набора байт, согласно строковой конфигурации
- конфигурация подключения к базеданных: mongo.host = dbServer01 (согласно production окружения)

## 17.06.2016
### 0.6.22

- PostProcessor - добавлен вызов новых обработчиков
- ExtractRule (транспортный пакет) - добавлены поля byteOrder, utc, valueMap
- Extractor - методы обработки BCD формата, извлечение даны из массива байт с применением конфигурации (строки), извлечение целочисленного значения (без учета сортировки байт - только прямой порядок), получение даны из масива байт с применением строкового конфига
- MessageRouter - добавлена обработка ситуации разбивки сообщения от устройства на куски радиомодулем. Payload сообщений типа ZigbeeTransmitResponse объединяются в единый массив и далее отправляются на стандартный обработчик, как единое сообщение Front-net
- Extractor - добавлен метод getMagikaD2Float для конвертирования формата FLOAT32 протокола D2 тепловычислитея Магика (в корректный формат IEEE 754) и извлениче дробного значения

## 17.05.2016
### 0.6.12

- Extractor - добавлены методы извлечениея Integer (2 регистра с переворотом) из ModBus и на основании данного метода - извлечение даты в формате UTC с нулевой часовой зоной, соотвествующие корректировки в PostProcessor
- Scheduler - настроена работа метода run5min (запуск по крону из настроек, без удаления исходного json-пакета)
- Scheduler - начальная регистрация пакета для обмена переведела на PreProcessor
- DeviceDataService - сохранение полей с данными на основании настроек в сущности Device (ранее поля брались из DeviceType)
- PreProcessor - добавлена отправка подготовленного пакета на TransportPacketProcessor
- ActionPoint - метод установки payload



## 17.05.2016
### 0.6.1

- use ASD Entities version 1.0.14 
- Добавлен шедулер (пока один метод с удалением полученного файла) + кофигурация через application.properties
- AbstractEntityController - возможность выполнять запросы к коллекции без учета класса
- AbstractEntityController - добавлена абстракция для подгтовки фильтрующих запросов к базе
- Транспортная подсистема - доработан механизм обработки сообщений ZigBee (возврат извлеченных данных обратно в MessageRouter)
- Транспортная подсистема - добавлена обработка транаспортного пакета с учетом наличия радимодуля (подготовка соответсвующих запросов с адресацией по зигби)
- AsyncTransportPacket - при регистрации пакета в процессоре из базы извлекается информация о frontDevices
- Добавлена возможность очистки requestPool у deviceChannel
- Добавлена возможность очистки очереди пакетов
- Добавлены тестовые методы работы с пакетом (изменения коснулись ChannelController, FrontDeviceController)
- PostProcessor - добавлен механихм извлечения Integer из ModBus ответа

## 17.05.2016
### 0.5.7

- use ASD Entities version 1.0.8 
- DeviceTypeController - добавлена обработка поля alias при добавлении новой сущности. В случае, если пользователь указал знаение - используется оно, в ином варианте - используется генерация идентификатора от базового префикса класса
- AbstractEntityController - добавлена обработка исключения при попытке сохранения неуникального поля alias модели DeviceType
- Добавлено README.md для ведения истории изменений по проекту
- переход на production нумерацию версий
- Добавлены контроллеры для моделей Box, BoxType
- Добавлена фильтрация всех запросов к базе по полю _class (для возможности использования одной коллекции для хранения разных классов). На текущий момент в единой коллекции размещаются модели Device и FrontDevice, как наследники от общего родительского класса
- Экспорт информации о версии приложения, версиях используемых нами библиотек (протокол и entities). Доступны по адресу /api/common/sysinfo в виде json-на
- .... иные исторические изменения по проекту опускаются. Смотреть git log